unit Unit5;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, Grids;

type
  TForm5 = class(TForm)
    btn1: TButton;
    strngrd1: TStringGrid;
    lbl1: TLabel;
    lbl2: TLabel;
    lbl3: TLabel;
    lbl5: TLabel;
    lbl6: TLabel;
    lbl7: TLabel;
    lbl8: TLabel;
    procedure btn1Click(Sender: TObject);
    procedure FormShow(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

const n=6;
var
  Form5: TForm5;
  masx: array [1..6] of real =
  (3.0, 3.1, 3.2, 3.3, 3.4, 3.5);
  masy: array [1..6] of Real =
  (25.0, 29.4, 34.4, 40.4, 47.6, 56.0);

implementation

{$R *.dfm}

procedure TForm5.btn1Click(Sender: TObject);
begin
  Form5.Close;
end;

procedure TForm5.FormShow(Sender: TObject);
var
  i,j: byte;
  sum_x,sum_X2,sum_y,sum_xy,A,B,Y,delta2: real;
begin
  //Начальное заполнение таблицы
  strngrd1.Cells[0,n+1]:='Сумма';
  strngrd1.Cells[0,0]:='k';
  strngrd1.Cells[1,0]:='x_k';
  strngrd1.Cells[2,0]:='y_k';
  for i:=1 to n do
    for j:=0 to 2 do
    begin
      if j=0 then strngrd1.Cells[j,i]:=IntToStr(i);
      if j=1 then strngrd1.Cells[j,i]:=FloatToStr(masx[i]);
      if j=2 then strngrd1.Cells[j,i]:=FloatToStr(masy[i]);
    end;
  //Расчет необходимых параметров
  sum_x:=0;
  for i:=1 to n do
    sum_x:=sum_x+masx[i];
  strngrd1.Cells[1,n+1]:=FloatToStr(sum_x);
  sum_y:=0;
  for i:=1 to n do
  sum_y:=sum_y+masy[i];
   strngrd1.Cells[2,n+1]:=FloatToStr(sum_y);
  sum_xy:=0;
  strngrd1.Cells[3,0]:='XiYi';
  for i:=1 to n do
    begin
      strngrd1.Cells[3,i]:=FloatToStr(masx[i]*masy[i]);
      sum_xy:=sum_xy+masx[i]*masy[i];
    end;
  strngrd1.Cells[3,n+1]:=FloatToStr(sum_xy);
  strngrd1.Cells[4,0]:='X^2';
  sum_x2:=0;
  for i:=1 to n do
    begin
      strngrd1.Cells[4,i]:=FloatToStr(masx[i]*masx[i]);
      sum_x2:=sum_x2+masx[i]*masx[i];
    end;
  strngrd1.Cells[4,n+1]:=FloatToStr(sum_x2);

  //считаем A и B
  lbl5.Caption:='А*' + strngrd1.Cells[4,n+1] + ' + B*' + strngrd1.Cells[1,n+1] + ' = ' + strngrd1.Cells[3,n+1];
  lbl6.Caption:='А*' + strngrd1.Cells[1,n+1] + ' + B*' + inttostr(n) + ' = ' + strngrd1.Cells[2,n+1];

  A:=5.8928;  //решай сам
  B:=-5.9285;
  strngrd1.Cells[5,0]:='Yтеор';
  for i:=1 to n do
  strngrd1.Cells[5,i]:=FloatToStr(a*masx[i]+b);
   strngrd1.Cells[6,0]:='Yk - Yтеор';
   strngrd1.Cells[7,0]:='(Yk - Yтеор)^2';
   delta2:=0;
  for i:=1 to n do
    begin
      strngrd1.Cells[6,i]:=FloatToStr(StrToFloat(strngrd1.Cells[2,i])-StrToFloat(strngrd1.Cells[5,i]));
      strngrd1.Cells[7,i]:=FloatToStr(sqr(StrToFloat(strngrd1.Cells[6,i])));
      delta2:=delta2+strtofloat(strngrd1.Cells[7,i]);
    end;
   strngrd1.Cells[7,n+1]:=FloatToStr(delta2);
   lbl1.Caption:='Среднее квадратичное отклонение = '+FloatToStr((Sqrt(delta2))/n);

lbl7.Caption:='Ответ: A= ' + floattostr(A) + ' ; B= ' + floattostr(B) +';';
lbl8.Caption:='Полученная зависимость Y= '+ floattostr(A) + '*x + (' + floattostr(B) + ').';


   end;

end.
